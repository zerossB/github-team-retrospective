<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Team Retrospective - {{ organization }}</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.plot.ly/plotly-3.3.0.min.js"></script>
  <script>
    // Tailwind on-the-fly theme extension using CSS variables
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            brand: 'var(--brand)',
            brand2: 'var(--brand-2)',
            surface: 'var(--surface)',
            card: 'var(--card)',
            muted: 'var(--muted)',
          },
          boxShadow: {
            glow: '0 10px 60px rgba(0,0,0,0.25)',
          },
        },
      },
    }
  </script>
  <style>
    /* Easy color customization */
    :root {
      --brand: #6366f1;
      --brand-2: #a855f7;
      --surface: #0b1224;
      --card: #0f172a;
      --muted: #cbd5e1;
    }

    .brand-gradient {
      background: linear-gradient(135deg, var(--brand) 0%, var(--brand-2) 100%);
    }
  </style>
</head>
<body class="bg-[radial-gradient(circle_at_20%_20%,rgba(99,102,241,0.12),transparent_25%),radial-gradient(circle_at_80%_0%,rgba(168,85,247,0.12),transparent_25%),#0b1224] text-slate-100 min-h-screen">
  <div class="max-w-6xl mx-auto px-5 py-10">
    <!-- Header -->
    <header class="brand-gradient rounded-3xl p-10 shadow-glow mb-8 border border-white/10">
      <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-6">
        <div>
          <p class="uppercase tracking-[0.2em] text-xs font-semibold text-white/80">GitHub Team Retrospective</p>
          <h1 class="text-4xl md:text-5xl font-black mt-2 text-white">ğŸ“Š Team Retrospective</h1>
          <p class="text-white/90 mt-3 text-lg font-medium">{{ organization }}</p>
          <p class="text-white/80 text-sm mt-1">{{ start_date }} to {{ end_date }}</p>
          <p class="text-white/70 text-xs mt-2">Generated on {{ generated_at }}</p>
        </div>
        <div class="bg-white/10 rounded-2xl px-6 py-5 text-white/90 border border-white/20">
          <p class="text-sm uppercase tracking-wide text-white/70">Summary</p>
          <p class="text-3xl font-bold">{{ total_repos }} repos</p>
          <p class="text-sm text-white/80">{{ total_commits }} commits â€¢ {{ total_prs }} PRs â€¢ {{ total_issues }} issues</p>
        </div>
      </div>
    </header>

    <!-- Stat Cards -->
    <section class="grid gap-4 sm:grid-cols-2 xl:grid-cols-5 mb-10">
      <div class="bg-slate-900/70 border border-white/5 rounded-2xl p-5 shadow-glow">
        <div class="text-2xl">ğŸ“š</div>
        <p class="text-3xl font-bold text-brand mt-2">{{ total_repos }}</p>
        <p class="text-sm text-muted">Repositories</p>
      </div>
      <div class="bg-slate-900/70 border border-white/5 rounded-2xl p-5 shadow-glow">
        <div class="text-2xl">ğŸ’»</div>
        <p class="text-3xl font-bold text-brand mt-2">{{ total_commits }}</p>
        <p class="text-sm text-muted">Commits</p>
      </div>
      <div class="bg-slate-900/70 border border-white/5 rounded-2xl p-5 shadow-glow">
        <div class="text-2xl">ğŸ”€</div>
        <p class="text-3xl font-bold text-brand mt-2">{{ total_prs }}</p>
        <p class="text-sm text-muted">Pull Requests</p>
      </div>
      <div class="bg-slate-900/70 border border-white/5 rounded-2xl p-5 shadow-glow">
        <div class="text-2xl">ğŸ›</div>
        <p class="text-3xl font-bold text-brand mt-2">{{ total_issues }}</p>
        <p class="text-sm text-muted">Issues</p>
      </div>
      <div class="bg-slate-900/70 border border-white/5 rounded-2xl p-5 shadow-glow">
        <div class="text-2xl">ğŸ·ï¸</div>
        <p class="text-3xl font-bold text-brand mt-2">{{ total_releases }}</p>
        <p class="text-sm text-muted">Releases</p>
      </div>
    </section>

    <!-- Activity -->
    <section class="mb-10">
      <div class="flex items-center justify-between mb-4">
        <h2 class="text-2xl font-bold">ğŸ“ˆ Activity Over Time</h2>
      </div>
      {% if charts.commits_timeline %}
      <div class="bg-slate-900/70 border border-white/5 rounded-2xl p-4 shadow-glow">
        {{ charts.commits_timeline|safe }}
      </div>
      {% endif %}
    </section>

    <!-- Top Contributors -->
    <section class="mb-10 grid gap-6 lg:grid-cols-2">
      <div class="bg-slate-900/70 border border-white/5 rounded-2xl p-6 shadow-glow">
        <div class="flex items-center justify-between mb-4">
          <h2 class="text-2xl font-bold">ğŸ† Top Contributors</h2>
        </div>
        <ul class="space-y-3">
          {% for author, commits in top_contributors.items() %}
          <li class="flex items-center gap-3 bg-slate-800/80 rounded-xl px-4 py-3 border border-white/5">
            <span class="w-10 text-center text-lg font-bold">{{ loop.index }}</span>
            <span class="text-2xl">{% if loop.index == 1 %}ğŸ¥‡{% elif loop.index == 2 %}ğŸ¥ˆ{% elif loop.index == 3 %}ğŸ¥‰{% else %}ğŸ‘¤{% endif %}</span>
            <span class="flex-1 font-semibold">{{ author }}</span>
            <span class="text-brand font-bold">{{ commits }} commits</span>
          </li>
          {% endfor %}
        </ul>
        {% if charts.top_contributors_pie %}
        <div class="mt-6 bg-slate-800/60 rounded-xl p-3 border border-white/5">
          {{ charts.top_contributors_pie|safe }}
        </div>
        {% endif %}
      </div>

      <div class="bg-slate-900/70 border border-white/5 rounded-2xl p-6 shadow-glow">
        <div class="flex items-center justify-between mb-4">
          <h2 class="text-2xl font-bold">ğŸ‘€ Top Reviewers</h2>
        </div>
        <ul class="space-y-3">
          {% for reviewer, reviews in top_reviewers.items() %}
          <li class="flex items-center gap-3 bg-slate-800/80 rounded-xl px-4 py-3 border border-white/5">
            <span class="w-10 text-center text-lg font-bold">{{ loop.index }}</span>
            <span class="text-2xl">{% if loop.index == 1 %}ğŸ¥‡{% elif loop.index == 2 %}ğŸ¥ˆ{% elif loop.index == 3 %}ğŸ¥‰{% else %}ğŸ‘¤{% endif %}</span>
            <span class="flex-1 font-semibold">{{ reviewer }}</span>
            <span class="text-brand font-bold">{{ reviews }} reviews</span>
          </li>
          {% endfor %}
        </ul>
      </div>
    </section>

    <!-- Languages & PRs -->
    <section class="mb-10 grid gap-6 lg:grid-cols-2">
      {% if charts.languages_pie %}
      <div class="bg-slate-900/70 border border-white/5 rounded-2xl p-6 shadow-glow">
        <h2 class="text-2xl font-bold mb-4">ğŸ’» Languages Used</h2>
        {{ charts.languages_pie|safe }}
      </div>
      {% endif %}

      {% if charts.prs_by_repo %}
      <div class="bg-slate-900/70 border border-white/5 rounded-2xl p-6 shadow-glow">
        <h2 class="text-2xl font-bold mb-4">ğŸ”€ Pull Requests per Repository</h2>
        {{ charts.prs_by_repo|safe }}
      </div>
      {% endif %}
    </section>

    <!-- Repository Breakdown -->
    <section class="mb-12">
      <div class="flex items-center justify-between mb-4">
        <h2 class="text-2xl font-bold">ğŸ“š Repository Breakdown</h2>
      </div>
      <div class="space-y-6">
        {% for repo in repositories %}
        <div class="bg-slate-900/70 border border-white/5 rounded-2xl p-6 shadow-glow">
          <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-3">
            <div>
              <a href="{{ repo.url }}" target="_blank" class="text-brand font-bold text-xl hover:underline">
                {{ repo.name }} â†—
              </a>
              <p class="text-muted text-sm mt-1">{{ repo.description or 'No description' }}</p>
            </div>
            <div class="flex flex-wrap gap-2 text-xs uppercase tracking-wide text-white/60">
              {% if repo.language %}<span class="bg-white/10 border border-white/10 px-2 py-1 rounded-full">{{ repo.language }}</span>{% endif %}
              <span class="bg-white/10 border border-white/10 px-2 py-1 rounded-full">â­ {{ repo.stars }}</span>
              <span class="bg-white/10 border border-white/10 px-2 py-1 rounded-full">ğŸ´ {{ repo.forks }}</span>
            </div>
          </div>

          <div class="grid gap-3 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 mt-5">
            <div class="bg-slate-800/60 border border-white/5 rounded-xl p-4 text-center">
              <div class="text-xl">ğŸ’»</div>
              <p class="text-2xl font-bold text-brand">{{ repo.commits.total }}</p>
              <p class="text-xs text-muted">Commits</p>
            </div>
            <div class="bg-slate-800/60 border border-white/5 rounded-xl p-4 text-center">
              <div class="text-xl">ğŸ”€</div>
              <p class="text-2xl font-bold text-brand">{{ repo.pull_requests.total }}</p>
              <p class="text-xs text-muted">PRs</p>
            </div>
            <div class="bg-slate-800/60 border border-white/5 rounded-xl p-4 text-center">
              <div class="text-xl">âœ…</div>
              <p class="text-2xl font-bold text-brand">{{ repo.pull_requests.merged }}</p>
              <p class="text-xs text-muted">Merged</p>
            </div>
            <div class="bg-slate-800/60 border border-white/5 rounded-xl p-4 text-center">
              <div class="text-xl">ğŸ›</div>
              <p class="text-2xl font-bold text-brand">{{ repo.issues.total }}</p>
              <p class="text-xs text-muted">Issues</p>
            </div>
            <div class="bg-slate-800/60 border border-white/5 rounded-xl p-4 text-center">
              <div class="text-xl">ğŸ·ï¸</div>
              <p class="text-2xl font-bold text-brand">{{ repo.releases.total }}</p>
              <p class="text-xs text-muted">Releases</p>
            </div>
            <div class="bg-slate-800/60 border border-white/5 rounded-xl p-4 text-center">
              <div class="text-xl">â±ï¸</div>
              <p class="text-2xl font-bold text-brand">{{ "%.1f"|format(repo.pull_requests.avg_merge_time_hours) }}h</p>
              <p class="text-xs text-muted">Avg merge time</p>
            </div>
          </div>
        </div>
        {% endfor %}
      </div>
    </section>

    <footer class="text-center text-white/60 text-sm border-t border-white/5 pt-6 mt-10">
      <p>ğŸš€ GitHub Team Retrospective</p>
      <p class="text-xs mt-1">Generated automatically</p>
    </footer>
  </div>
</body>
</html>
